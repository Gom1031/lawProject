<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Register</title>

    <!-- main_register.html -->
    <script>
        document.querySelector('form').addEventListener('submit', async function(event) {
            event.preventDefault();
            const data = {
                username: this.elements.username.value,
                password: this.elements.password.value,
                email: this.elements.email.value,
                phone_number: this.elements.phone_number.value
            };
            const response = await fetch('/api/user/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });
            if (response.ok) {
                alert('User registered successfully');
                location.href = '/user/login';
            } else {
                const error = await response.json();
                alert('Error: ' + error.message);
            }
        });
    </script>

</head>

<body>
<h1>Register</h1>
    <form action="#" th:action="@{/user/register}" th:object="${user}" method="post">
        <p>Username: <input type="text" th:field="*{username}" /></p>
        <p>Password: <input type="password" th:field="*{password}" /></p>
        <p>Email: <input type="email" th:field="*{email}" /></p>
        <p>Phone number: <input type="text" th:field="*{phone_number}" /></p>
        <p><input type="submit" value="Submit" /> <input type="reset" value="Reset" /></p>
    </form>
    <p th:if="${error}" th:text="${error}">Error message</p>
</body>

</html>
